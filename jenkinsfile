pipeline {
  agent none
  stages {
    stage('Clean workspace') {
      agent any
      steps {
        sh 'echo cleaning workspace'
        sh 'rm -rf *'
        sh 'Removing any .git stores'
        sh 'rm -rf .git'
        sh 'echo All done!'
      }
    }
    stage('Pull the code') {
      agent any
      steps {
        git branch: 'dev',
        changelog: false,
        credentialsId: 'ssh_username_with_ky',
        poll: false,
        url: 'https://github.com/codabilly/pipelines'
      }
    }
    stage('Promote to uat') {
      agent any
      steps {
        sh '''
          echo $(git status);
          echo $(git branch -a);
          git checkout uat;
          git merge dev;
        '''
      }
    }
  }
}
// stages {
//   stage('name') {
//     agent any
//     steps {
//
//     }
//   }
