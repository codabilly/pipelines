pipeline {
  agent none
  stages {
      stage('Listing out the directory') {
        agent any
        steps {
          sh 'echo Doing an ls on $(pwd)'
          sh 'ls -ltr'
        }
      }
      stage('Pull the code') {
        agent any
        steps {
          git branch: 'dev',
          changelog: false,
          credentialsId: 'ssh_username_with_ky',
          poll: false,
          url: 'https://github.com/codabilly/pipelines'
        }
      }
      stage('Listing out the directory, again....') {
        agent any
        steps {
          sh 'echo Doing an ls on $(pwd)'
          sh 'ls -ltr'
        }
      }
      stage('Promote to UAT') {
        agent any
        steps {
          sh '''
            echo $(git status);
            echo $(git branch);
            git checkout dev;
            git checkout UAT;
            git merge dev;
          '''
        }
      }
    }
  }
